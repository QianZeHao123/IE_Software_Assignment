# 1 金属退火
## 1.1 金属退火概念：
金属退火是一种化学上的热处理技术，指的是将金属加热到一定温度后再以适宜速度冷却。金属退火可以改变金属的一些物理性质，化学性质，以达到某种特殊的用途。<br>

## 1.2 金属退火化学模型：
加热后金属原子最初处于某种活跃的状态，此时原子的活跃程度为x1，金属的内能E(x1)可由x得来，温度为T1<br>
降温时金属原子的活跃程度逐渐下降，此时原子的活跃程度为x2，金属的内能E(x2)可由x得来，温度为T2<br>
当温度降至稳定温度时金属原子的活跃程度最低，此时原子的活跃程度为x3，金属的内能E(x3)可由x得来，温度为T3<br>

# 2.模拟退火
## 2.1 模拟退火参数：
模拟退火模型由“金属退火化学模型”改进得来，模拟退火关注如下几种参数：<br />
金属原子的活跃程度x，对应着问题的某一种解决方案<br />
金属的内能E，对应着使用x解决方案解决问题最后的到的结果<br />
金属的温度T，对应着解决问题要进行的迭代次数，温度有初始温度，终止温度，降温系数，三者共同控制迭代次数<br />
金属降温系数α，α是一个[0, 1]之间的数，表示每次温度降低的幅度，T在降低时T = αT

## 2.2 模拟退火流程
## 2.3 Metropolis准则
Metropolis准则公式：<br />
P表示是否让新的解决方案代替当前解决方案。<br />
Et+1表示新解决方案，对应金属退火中的t+1温度下的金属内能。<br />
T表示当前温度，k表示降温系数。<br />
Metropolis准则带来的优势：<br />
Metropolis准则是模拟退火的优势所在，在机器学习的梯度下降法中可能会遇到局部最优解。这种情况下往往需要调整梯度下降的步长和迭代次数来越过局部最优解。上述流程图中的随机扰动+Metropolis准则给予了模拟退火算法不确定性，即使当前获取的了最优解，也会再次探测是否存该解是局部最优，是否存在全局最优解。<br />
## 2.4 模拟退火举例：旅行商TSP问题
问题描述：<br />
有N个城市，任意一个城市i到其它城市都有一条双向道路且长度为Li。现在旅行商想从某个城市出发要访问这N个城市，且每个城市只能访问一次。旅行商希望他经过这N个城市所走的路线是最短路线，那么旅行商该从哪个城市出发，又应该走什么样的路线呢？<br />
阐述流程：<br />
边是N^2级别，适合使用邻接矩阵存图。几种经典最短路算法，并不使用此情景，给出起点终点，但是无法保证一定经过所有节点。使用搜索算法的开销较大。此时考虑使用模拟退火算法解决，流程如下：<br />
* 设置初始温度为2000，终止温度为0.1，降温系数为0.98<br />
* 随机生成一组解决方案，旅行商从1城市出发，顺序经过其它城市，最后到N城市，再回到1城市。
* 设置随机扰动，随意将解决方案中的两个城市交换顺序<br />
* 计算扰动后的路线长度和扰动前的路线长度哪个更优，扰动后优则更新解决方案，扰动前优则根据etropolis决定是否更新解决方案<br />
* 温度乘降温系数，温度下降<br />
* 判断温度是否低于终止温度<br />
* 低于终止温度则输出最短路长度和访问这些城市的顺序（如果最短路长度不满意，可以在此重置温度为初始温度，重新迭代）<br />
# 3算法实现：（JavaScript）<br />
* 运行环境：NodeJS或chrome浏览器调试框
* 运行：
```bash
node SA.js  # 电脑中已经安装了node环境
```
